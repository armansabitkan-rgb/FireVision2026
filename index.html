<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FireVision — Satellite POV</title>
  <style>
    :root{
      --bg:#060712;
      --text:#ffffff;
      --muted:rgba(255,255,255,.78);
      --glass:rgba(255,255,255,.07);
      --border:rgba(255,255,255,.14);
      --accent:#ff7a2a;
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:system-ui,Segoe UI,Arial;overflow:hidden}
    body{
      background: radial-gradient(1200px 900px at 15% 20%, rgba(155,92,255,.15), transparent 60%),
                  radial-gradient(900px 700px at 80% 25%, rgba(59,230,255,.10), transparent 62%),
                  radial-gradient(1100px 850px at 55% 90%, rgba(255,122,42,.10), transparent 60%),
                  var(--bg);
      color:var(--text);
    }
    #bg3d{ position:fixed; inset:0; width:100%; height:100%; display:block; z-index:0; }

    .wrap{
      position:relative; z-index:5; height:100%;
      padding:clamp(18px, 4vw, 54px);
      display:grid; grid-template-columns: 1.15fr 0.85fr;
      gap:28px; align-items:center;
      pointer-events:none;
    }
    @media (max-width: 980px){
      .wrap{grid-template-columns:1fr; height:auto; padding:22px 18px 110px;}
      body{overflow:auto}
    }

    .brand{
      position:fixed; left: clamp(18px, 4vw, 54px); top: 18px; z-index:6;
      display:flex; gap:10px; align-items:center; padding:10px 12px;
      border-radius: 14px; border: 1px solid rgba(255,255,255,.12);
      background: rgba(0,0,0,.18); backdrop-filter: blur(10px);
      color: rgba(255,255,255,.9); pointer-events:none;
    }
    .brand .logoDot{
      width:10px;height:10px;border-radius:50%;
      background: rgba(255,122,42,.95); box-shadow: 0 0 18px rgba(255,122,42,.35);
    }
    .brand .t1{font-weight:800; letter-spacing:.04em}
    .brand .t2{color: rgba(255,255,255,.65); font-size:12px}

    .headline{
      margin:0; font-weight: 900; letter-spacing:-0.03em; line-height:0.96;
      text-shadow: 0 0 26px rgba(255,255,255,.06);
      font-size: clamp(34px, 5.2vw, 76px);
    }
    .tagline{
      margin-top:14px; max-width: 760px; color: var(--muted);
      font-size: clamp(14px, 1.55vw, 18px); line-height:1.55;
    }

    .card{
      background: var(--glass); border: 1px solid var(--border);
      border-radius: 18px; padding: 18px 18px 16px;
      box-shadow: 0 20px 70px rgba(0,0,0,.35);
      backdrop-filter: blur(12px); pointer-events:auto;
    }
    .card h2{margin:0 0 12px 0;font-size:18px;letter-spacing:.02em;color: rgba(255,255,255,.92);}
    .targets{list-style:none;padding:0;margin:0;display:grid;gap:10px;}
    .targets li{
      display:flex;gap:10px;align-items:flex-start;
      padding:10px 12px;border-radius:14px;
      border:1px solid rgba(255,255,255,.10); background: rgba(0,0,0,.22);
      color: rgba(255,255,255,.88); font-size:14px; line-height:1.35;
    }
    .dot2{width:10px;height:10px;border-radius:50%;margin-top:6px;background: #ff2200;box-shadow: 0 0 18px #ff2200;flex:0 0 auto;}

    .btnRow{margin-top:16px;display:flex;gap:12px;align-items:center;}
    .btn, .btn:visited{
      flex:1;display:inline-flex;align-items:center;justify-content:center;
      padding: 14px 16px;border-radius: 16px; border: 1px solid rgba(255,255,255,.18);
      background: linear-gradient(180deg, rgba(255,122,42,.22), rgba(255,122,42,.10));
      color:#fff;font-weight:800;letter-spacing:.08em;text-transform:uppercase;
      text-decoration:none; user-select:none; transition: transform .15s ease, background .2s ease;
    }
    .btn:hover{ transform: translateY(-1px); background: linear-gradient(180deg, rgba(255,122,42,.28), rgba(255,122,42,.12)); }

    .btnGhost{
      flex:1; display:inline-flex; align-items:center; justify-content:center;
      padding:14px 16px; border-radius:16px; border:1px solid rgba(255,255,255,.16);
      background: rgba(255,255,255,.06); color: rgba(255,255,255,.88);
      font-weight:800; letter-spacing:.08em; text-transform:uppercase;
      text-decoration:none; user-select:none; transition: transform .15s ease, background .2s ease;
    }
    .btnGhost:hover{ transform: translateY(-1px); background: rgba(255,255,255,.12); }

    .hintBox{
      position:fixed; left: clamp(18px, 4vw, 54px); bottom: 16px; z-index:6;
      padding:10px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.22); backdrop-filter: blur(10px);
      color: rgba(255,255,255,.78); font-size:12px; pointer-events:none;
      max-width:min(680px, 92vw); line-height:1.35;
    }
    .kbd{font-family:ui-monospace,Consolas,monospace;color:rgba(255,255,255,.92)}
  </style>
</head>

<body>
  <canvas id="bg3d"></canvas>

  <div class="brand">
    <span class="logoDot"></span>
    <div>
      <div class="t1">FIREVISION</div>
      <div class="t2">Satellite POV • Global Monitoring</div>
    </div>
  </div>

  <div class="wrap">
    <div>
      <h1 class="headline">FireVision Satellite Project</h1>
      <div class="tagline">
        Глобальный спутниковый мониторинг: обнаружение аномалий, верификация ИИ и лаборатория симуляций.
      </div>
    </div>

    <div class="card">
      <h2>Global Status</h2>
      <ul class="targets">
        <li><span class="dot2"></span>10 крупных очагов обнаружено системой.</li>
        <li><span class="dot2"></span>Спутник на орбите собирает данные (drag to rotate).</li>
        <li><span class="dot2"></span>ИИ отфильтровал океаны и ложные засветы.</li>
      </ul>

      <div class="btnRow">
        <a class="btn" href="dashboard.html">Enter Mission Control</a>
        <a class="btnGhost" href="payload.html">View Payload Tech</a>
      </div>
    </div>
  </div>

  <div class="hintBox">
    Controls: <span class="kbd">LMB + drag</span> rotate • <span class="kbd">mouse wheel</span> next/prev hotspot. 
  </div>

  <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
  <script>
    // ===== Canvas / Renderer =====
    const canvas = document.getElementById('bg3d');
    const renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:true });
    renderer.setPixelRatio(Math.min(2, window.devicePixelRatio));
    renderer.outputColorSpace = THREE.SRGBColorSpace;
    renderer.setSize(window.innerWidth, window.innerHeight);

    const scene = new THREE.Scene();

    // ===== Camera =====
    const camera = new THREE.PerspectiveCamera(55, window.innerWidth/window.innerHeight, 0.1, 500);
    scene.add(camera);

    const earthRadius = 2.0;
    const camDist = 6.2;
    let yaw = 0.6, pitch = 0.25;
    let targetYaw = yaw, targetPitch = pitch;

    // ===== Lights =====
    scene.add(new THREE.AmbientLight(0xffffff, 0.20));
    const key = new THREE.DirectionalLight(0xffffff, 1.25);
    key.position.set(-8, 4, 6);
    scene.add(key);
    const rim = new THREE.DirectionalLight(0x88ccff, 0.35);
    rim.position.set(6, -2, -6);
    scene.add(rim);

    // ===== Sun & Stars & Nebula =====
    function makeSunTex(){
      const c = document.createElement('canvas'); c.width = 512; c.height = 512; const ctx = c.getContext('2d');
      const g = ctx.createRadialGradient(256,256,0,256,256,260);
      g.addColorStop(0.0, 'rgba(255,245,210,0.92)'); g.addColorStop(0.2, 'rgba(255,190,120,0.50)');
      g.addColorStop(0.5, 'rgba(255,140,70,0.18)'); g.addColorStop(1.0, 'rgba(0,0,0,0)');
      ctx.fillStyle = g; ctx.fillRect(0,0,512,512);
      const tex = new THREE.CanvasTexture(c); tex.colorSpace = THREE.SRGBColorSpace; return tex;
    }
    const sunSprite = new THREE.Sprite(new THREE.SpriteMaterial({ map: makeSunTex(), transparent:true, opacity:0.56, depthWrite:false, blending: THREE.AdditiveBlending }));
    sunSprite.position.set(-10, 6, -18); sunSprite.scale.set(22, 22, 1);
    scene.add(sunSprite);

    const starCount = 3200;
    const starGeom = new THREE.BufferGeometry();
    const starPos = new Float32Array(starCount * 3);
    for (let i=0; i<starCount; i++){
      const r = 170 * Math.random() + 30;
      const theta = Math.random()*Math.PI*2;
      const phi = Math.acos(2*Math.random()-1);
      starPos[i*3+0] = r*Math.sin(phi)*Math.cos(theta); starPos[i*3+1] = r*Math.sin(phi)*Math.sin(theta); starPos[i*3+2] = r*Math.cos(phi);
    }
    starGeom.setAttribute('position', new THREE.BufferAttribute(starPos, 3));
    const stars = new THREE.Points(starGeom, new THREE.PointsMaterial({ size:0.085, transparent:true, opacity:0.88 }));
    scene.add(stars);

    // ===== Earth =====
    const earth = new THREE.Mesh(
      new THREE.SphereGeometry(earthRadius, 64, 64),
      new THREE.MeshPhongMaterial({ color: 0xdddddd }) 
    );
    scene.add(earth);

    const atmosphere = new THREE.Mesh(
      new THREE.SphereGeometry(earthRadius*1.03, 64, 64),
      new THREE.MeshBasicMaterial({ transparent:true, opacity:0.08, color: 0x88ccff })
    );
    earth.add(atmosphere);

    const loader = new THREE.TextureLoader();
    // ИСПРАВЛЕННЫЙ ПУТЬ: теперь мы берем текстуру из папки assets
    loader.load('assets/earth.jpg', (tex) => {
        tex.colorSpace = THREE.SRGBColorSpace;
        earth.material.map = tex;
        earth.material.needsUpdate = true;
    });

    // ==========================================
    // КРАСНЫЕ РАДАРНЫЕ ТОЧКИ (Увеличенные)
    // ==========================================
    function makeRadarBlipTexture() {
      const canvas = document.createElement('canvas');
      canvas.width = 256; canvas.height = 256;
      const ctx = canvas.getContext('2d');
      const cx = 128; const cy = 128;

      // Насыщенная красная свечащаяся аура
      const gradient = ctx.createRadialGradient(cx, cy, 0, cx, cy, 128);
      gradient.addColorStop(0, 'rgba(255, 50, 0, 1)');      // Очень яркий центр
      gradient.addColorStop(0.4, 'rgba(255, 20, 0, 0.85)'); // Широкая плотная зона
      gradient.addColorStop(0.8, 'rgba(255, 0, 0, 0.3)');
      gradient.addColorStop(1, 'rgba(255, 0, 0, 0)');

      ctx.fillStyle = gradient;
      ctx.fillRect(0, 0, 256, 256);

      // Крупное белое ядро
      ctx.beginPath();
      ctx.arc(cx, cy, 22, 0, Math.PI * 2);
      ctx.fillStyle = '#ffffff';
      ctx.shadowColor = '#ff2200';
      ctx.shadowBlur = 15;
      ctx.fill();

      const texture = new THREE.CanvasTexture(canvas);
      texture.colorSpace = THREE.SRGBColorSpace;
      return texture;
    }

    const blipTexture = makeRadarBlipTexture();

    // 10 Жестких координат по всему миру
    const landCoordinates = [
      { lat: 37.7749, lon: -122.4194 }, // Калифорния
      { lat: -3.4653, lon: -62.2159 },  // Амазония
      { lat: -33.8688, lon: 151.2093 }, // Австралия
      { lat: 62.0397, lon: 129.7422 },  // Сибирь
      { lat: -1.2921, lon: 36.8219 },   // Африка
      { lat: 53.7267, lon: -127.6476 }, // Канада
      { lat: 39.0742, lon: 21.8243 },   // Греция (Средиземноморье)
      { lat: -0.7893, lon: 113.9213 },  // Индонезия
      { lat: -38.4161, lon: -63.6167 }, // Аргентина
      { lat: 48.0196, lon: 66.9237 }    // Казахстан (степи)
    ];

    function latLonToVec(latDeg, lonDeg, r){
      const lat = latDeg * Math.PI/180;
      const lon = lonDeg * Math.PI/180;
      const x = r * Math.cos(lat) * Math.cos(lon);
      const y = r * Math.sin(lat);
      const z = r * Math.cos(lat) * Math.sin(lon);
      return new THREE.Vector3(x,y,z);
    }

    const hotspots = [];
    
    // Создаем точки и добавляем их на Землю
    landCoordinates.forEach(coord => {
      const v = latLonToVec(coord.lat, coord.lon, earthRadius * 1.02); 
      
      const spriteMaterial = new THREE.SpriteMaterial({
        map: blipTexture,
        transparent: true,
        opacity: 1,
        depthWrite: false, 
        blending: THREE.AdditiveBlending 
      });
      
      const sprite = new THREE.Sprite(spriteMaterial);
      sprite.position.copy(v);
      earth.add(sprite);

      hotspots.push({
        sprite: sprite,
        vec: v.clone().normalize(),
        phase: Math.random() * Math.PI * 2 
      });
    });

    // ===== Realistic Satellite Model =====
    function makeSolarPanelTex(){
      const c = document.createElement('canvas'); c.width = 512; c.height = 256; const ctx = c.getContext('2d');
      ctx.fillStyle = '#0b1d3a'; ctx.fillRect(0,0,c.width,c.height);
      ctx.globalAlpha = 0.25; ctx.strokeStyle = '#7fd3ff';
      for(let x=0; x<=512; x+=32){ ctx.beginPath(); ctx.moveTo(x,0); ctx.lineTo(x,256); ctx.stroke(); }
      for(let y=0; y<=256; y+=32){ ctx.beginPath(); ctx.moveTo(0,y); ctx.lineTo(512,y); ctx.stroke(); }
      ctx.globalAlpha = 1;
      const g = ctx.createLinearGradient(0,0,512,0);
      g.addColorStop(0, 'rgba(255,255,255,0.00)'); g.addColorStop(0.5, 'rgba(255,255,255,0.10)'); g.addColorStop(1, 'rgba(255,255,255,0.00)');
      ctx.fillStyle = g; ctx.fillRect(0,0,512,256);
      const tex = new THREE.CanvasTexture(c); tex.colorSpace = THREE.SRGBColorSpace; return tex;
    }
    const solarTex = makeSolarPanelTex();
    const sat = new THREE.Group();
    const metal = new THREE.MeshStandardMaterial({ color: 0xe6e6e6, roughness:0.45, metalness:0.75 });
    const darkMetal = new THREE.MeshStandardMaterial({ color: 0x30343a, roughness:0.55, metalness:0.65 });
    const goldFoil = new THREE.MeshStandardMaterial({ color: 0xd4a83b, roughness:0.8, metalness:0.35, emissive: new THREE.Color(0x241a08), emissiveIntensity:0.25 });
    const glassPanel = new THREE.MeshStandardMaterial({ map: solarTex, roughness:0.85, metalness:0.15, transparent:true, opacity:0.92, emissive: new THREE.Color(0x061020), emissiveIntensity:0.35 });

    sat.add(new THREE.Mesh(new THREE.BoxGeometry(0.65, 0.45, 0.45), metal));
    sat.add(new THREE.Mesh(new THREE.BoxGeometry(0.68, 0.48, 0.48), goldFoil));
    const payload = new THREE.Mesh(new THREE.CylinderGeometry(0.16, 0.16, 0.42, 28), darkMetal); payload.rotation.z = Math.PI/2; payload.position.set(0.0, 0.18, 0.0); sat.add(payload);
    const dish = new THREE.Mesh(new THREE.CylinderGeometry(0.22, 0.02, 0.14, 32, 1, true), darkMetal); dish.rotation.x = Math.PI/2; dish.position.set(0.42, -0.06, 0.0); sat.add(dish);
    const dishFace = new THREE.Mesh(new THREE.CircleGeometry(0.22, 32), new THREE.MeshStandardMaterial({ color: 0xb8c2cc, roughness:0.7, metalness:0.2 })); dishFace.position.set(0.49, -0.06, 0.0); dishFace.rotation.y = Math.PI/2; sat.add(dishFace);
    const boom = new THREE.Mesh(new THREE.CylinderGeometry(0.02, 0.02, 0.55, 16), darkMetal); boom.rotation.z = Math.PI/2; boom.position.set(-0.25, 0.0, 0.0); sat.add(boom);

    function solarPanel(x){
      const group = new THREE.Group();
      const frame = new THREE.Mesh(new THREE.BoxGeometry(1.05, 0.06, 0.42), darkMetal); frame.position.set(x, 0.0, 0.0); group.add(frame);
      const p1 = new THREE.Mesh(new THREE.PlaneGeometry(1.0, 0.38), glassPanel); p1.position.set(x, 0.0, 0.0); p1.rotation.y = Math.PI/2; group.add(p1);
      const p2 = new THREE.Mesh(new THREE.PlaneGeometry(1.0, 0.38), glassPanel); p2.position.set(x, 0.0, 0.0); p2.rotation.y = -Math.PI/2; group.add(p2);
      return group;
    }
    const panels = new THREE.Group();
    panels.add(solarPanel(-0.92)); panels.add(solarPanel( 0.92)); panels.rotation.y = Math.PI/2; sat.add(panels);
    sat.position.set(-1.25, -0.85, -2.35); sat.rotation.y = 0.45; sat.rotation.x = 0.10;
    camera.add(sat);

    // ===== Controls =====
    let dragging = false;
    let lastX = 0, lastY = 0;
    const clamp = (v,a,b)=>Math.max(a, Math.min(b,v));

    canvas.addEventListener('pointerdown', (e) => { dragging = true; lastX = e.clientX; lastY = e.clientY; canvas.setPointerCapture(e.pointerId); });
    canvas.addEventListener('pointerup', () => { dragging = false; });
    canvas.addEventListener('pointermove', (e) => {
      if(!dragging) return;
      const dx = e.clientX - lastX; const dy = e.clientY - lastY;
      lastX = e.clientX; lastY = e.clientY;
      targetYaw -= dx * 0.006; targetPitch -= dy * 0.006;
      targetPitch = clamp(targetPitch, -1.05, 1.05);
    });

    let hotspotIndex = 0;
    function focusHotspot(idx){
      if(!hotspots.length) return;
      const h = hotspots[idx];
      targetYaw = Math.atan2(h.vec.x, h.vec.z);
      targetPitch = Math.asin(h.vec.y);
    }
    canvas.addEventListener('wheel', (e) => {
      e.preventDefault();
      if(!hotspots.length) return;
      const dir = e.deltaY > 0 ? 1 : -1;
      hotspotIndex = (hotspotIndex + dir + hotspots.length) % hotspots.length;
      focusHotspot(hotspotIndex);
    }, { passive:false });

    // ===== Animation =====
    let t = 0;
    function animate(){
      requestAnimationFrame(animate);
      t += 0.01;

      yaw += (targetYaw - yaw) * 0.08;
      pitch += (targetPitch - pitch) * 0.08;

      const cx = camDist * Math.cos(pitch) * Math.sin(yaw);
      const cy = camDist * Math.sin(pitch);
      const cz = camDist * Math.cos(pitch) * Math.cos(yaw);
      camera.position.set(cx, cy, cz);
      camera.lookAt(0,0,0);

      earth.rotation.y += 0.0009;
      stars.rotation.y += 0.00025;
      sunSprite.material.opacity = 0.52 + Math.sin(t*0.7)*0.04;

      sat.rotation.z = Math.sin(t*0.9) * 0.03;
      panels.rotation.z = Math.sin(t*0.7) * 0.02;

      // ЛОГИКА АНИМАЦИИ РАДАРНЫХ ТОЧЕК (ОБНОВЛЕННАЯ)
      hotspots.forEach(h => {
        h.phase += 0.035; // Скорость пульсации
        const pulse = (Math.sin(h.phase) + 1) / 2; // Значение от 0 до 1
        
        // Масштаб увеличен в 2 раза
        const scale = 0.5 + (pulse * 0.8);
        h.sprite.scale.set(scale, scale, 1);
        
        // Точки теперь не пропадают полностью, а остаются видимыми
        h.sprite.material.opacity = 1 - (pulse * 0.6); 
      });

      renderer.render(scene, camera);
    }
    animate();

    window.addEventListener('resize', () => {
      renderer.setSize(window.innerWidth, window.innerHeight);
      camera.aspect = window.innerWidth / window.innerHeight;
      camera.updateProjectionMatrix();
    });
  </script>
</body>

</html>
